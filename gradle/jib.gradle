jib {
    from {
        image = "openjdk:21-slim"
//        platforms {
//            platform {
//                architecture = "arm64"
//                os = "linux"
//            }
//        }
    }

    to.image = "noahhsu/${project.name}"
    to.tags = ["latest"]

    container {
        creationTime = 'USE_CURRENT_TIMESTAMP'
    }

//    dockerClient.executable = '/opt/podman/bin/podman'

    pluginExtensions {
        pluginExtension {
            implementation = 'com.google.cloud.tools.jib.gradle.extension.springboot.JibSpringBootExtension'
        }
    }

    pluginExtensions {
        pluginExtension {
            implementation = 'com.google.cloud.tools.jib.gradle.extension.layerfilter.JibLayerFilterExtension'
            configuration {
                filters {
                    filter {
                        glob = '**/spring-boot-docker-compose-*.jar'
                    }
                }
            }
        }
    }
}
